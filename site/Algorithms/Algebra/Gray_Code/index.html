<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="Dmitry Ivanov">
    <link rel="canonical" href="https://d-k-ivanov.github.io/docs/Algorithms/Algebra/Gray_Code/">
    <link rel="shortcut icon" href="../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Gray Code - Technical Info</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <link href="../../../css/extra.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Gray Code", url: "#_top", children: [
              {title: "Finding Gray code", url: "#finding-gray-code" },
              {title: "Finding inverse Gray code", url: "#finding-inverse-gray-code" },
              {title: "Practical applications", url: "#practical-applications" },
              {title: "Practice Problems", url: "#practice-problems" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../mathjax-config.js"></script>
      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-80208201-1', 'd-k-ivanov.github.io');
        ga('send', 'pageview');
    </script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    

    <h1 id="gray-code">Gray Code</h1>
<p>Gray code is a binary numeral system where two successive values differ in only one bit.</p>
<p>For example, the sequence of Gray codes for 3-bit numbers is: 000, 001, 011, 010, 110, 111, 101, 100, so <span><span class="MathJax_Preview">G(4) = 6</span><script type="math/tex">G(4) = 6</script></span>.</p>
<p>This code was invented by Frank Gray in 1953.</p>
<h2 id="finding-gray-code">Finding Gray code</h2>
<p>Let's look at the bits of number <span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> and the bits of number <span><span class="MathJax_Preview">G(n)</span><script type="math/tex">G(n)</script></span>. Notice that <span><span class="MathJax_Preview">i</span><script type="math/tex">i</script></span>-th bit of <span><span class="MathJax_Preview">G(n)</span><script type="math/tex">G(n)</script></span> equals 1 only when <span><span class="MathJax_Preview">i</span><script type="math/tex">i</script></span>-th bit of <span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> equals 1 and <span><span class="MathJax_Preview">i + 1</span><script type="math/tex">i + 1</script></span>-th bit equals 0 or the other way around (<span><span class="MathJax_Preview">i</span><script type="math/tex">i</script></span>-th bit equals 0 and <span><span class="MathJax_Preview">i + 1</span><script type="math/tex">i + 1</script></span>-th bit equals 1). Thus, <span><span class="MathJax_Preview">G(n) = n \oplus (n &gt;&gt; 1)</span><script type="math/tex">G(n) = n \oplus (n >> 1)</script></span>:</p>
<pre><code class="language-cpp">int g (int n) {
    return n ^ (n &gt;&gt; 1);
}
</code></pre>
<h2 id="finding-inverse-gray-code">Finding inverse Gray code</h2>
<p>Given Gray code <span><span class="MathJax_Preview">g</span><script type="math/tex">g</script></span>, restore the original number <span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span>.</p>
<p>We will move from the most significant bits to the least significant ones (the least significant bit has index 1 and the most significant bit has index <span><span class="MathJax_Preview">k</span><script type="math/tex">k</script></span>). The relation between the bits <span><span class="MathJax_Preview">n_i</span><script type="math/tex">n_i</script></span> of number <span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> and the bits <span><span class="MathJax_Preview">g_i</span><script type="math/tex">g_i</script></span> of number <span><span class="MathJax_Preview">g</span><script type="math/tex">g</script></span>:</p>
<div>
<div class="MathJax_Preview">\begin{align}
  n_k &amp;= g_k, \\\\
  n_{k-1} &amp;= g_{k-1} \oplus n_k = g_k \oplus g_{k-1}, \\\\
  n_{k-2} &amp;= g_{k-2} \oplus n_{k-1} = g_k \oplus g_{k-1} \oplus g_{k-2}, \\\\
  n_{k-3} &amp;= g_{k-3} \oplus n_{k-2} = g_k \oplus g_{k-1} \oplus g_{k-2} \oplus g_{k-3}, \\\\
  \vdots
\end{align}</div>
<script type="math/tex; mode=display">\begin{align}
  n_k &= g_k, \\\\
  n_{k-1} &= g_{k-1} \oplus n_k = g_k \oplus g_{k-1}, \\\\
  n_{k-2} &= g_{k-2} \oplus n_{k-1} = g_k \oplus g_{k-1} \oplus g_{k-2}, \\\\
  n_{k-3} &= g_{k-3} \oplus n_{k-2} = g_k \oplus g_{k-1} \oplus g_{k-2} \oplus g_{k-3}, \\\\
  \vdots
\end{align}</script>
</div>
<p>The easiest way to write it in code is:</p>
<pre><code class="language-cpp">int rev_g (int g) {
  int n = 0;
  for (; g; g &gt;&gt;= 1)
    n ^= g;
  return n;
}
</code></pre>
<h2 id="practical-applications">Practical applications</h2>
<p>Gray codes have some useful applications, sometimes quite unexpected:</p>
<ul>
<li>
<p>Gray code of <span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> bits forms a Hamiltonian cycle on a hypercube, where each bit corresponds to one dimension.</p>
</li>
<li>
<p>Gray codes are used to minimize the errors in digital-to-analog signals conversion (for example, in sensors).</p>
</li>
<li>
<p>Gray code can be used to solve the Towers of Hanoi problem.
    Let <span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> denote number of disks. Start with Gray code of length <span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> which
    consists of all zeroes (<span><span class="MathJax_Preview">G(0)</span><script type="math/tex">G(0)</script></span>) and move between consecutive Gray codes (from <span><span class="MathJax_Preview">G(i)</span><script type="math/tex">G(i)</script></span> to <span><span class="MathJax_Preview">G(i+1)</span><script type="math/tex">G(i+1)</script></span>).
    Let <span><span class="MathJax_Preview">i</span><script type="math/tex">i</script></span>-th bit of current Gray code represent <span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span>-th disk
    (the least significant bit corresponds to the smallest disk and the most significant bit to the biggest disk).
    Since exactly one bit changes on each step, we can treat changing <span><span class="MathJax_Preview">i</span><script type="math/tex">i</script></span>-th bit as moving <span><span class="MathJax_Preview">i</span><script type="math/tex">i</script></span>-th disk.
    Notice that there is exactly one move option for each disk (except the smallest one) on each step (except start and finish positions).
    There are always two move options for the smallest disk but there is a strategy which will always lead to answer:
    if <span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> is odd then sequence of the smallest disk moves looks like <span><span class="MathJax_Preview">f \to t \to r \to f \to t \to r \to ...</span><script type="math/tex">f \to t \to r \to f \to t \to r \to ...</script></span>
    where <span><span class="MathJax_Preview">f</span><script type="math/tex">f</script></span> is the initial rod, <span><span class="MathJax_Preview">t</span><script type="math/tex">t</script></span> is the terminal rod and <span><span class="MathJax_Preview">r</span><script type="math/tex">r</script></span> is the remaining rod), and
    if <span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> is even: <span><span class="MathJax_Preview">f \to r \to t \to f \to r \to t \to ...</span><script type="math/tex">f \to r \to t \to f \to r \to t \to ...</script></span>.</p>
</li>
<li>
<p>Gray codes are also used in genetic algorithms theory.</p>
</li>
</ul>
<h2 id="practice-problems">Practice Problems</h2>
<ul>
<li><a href="http://codeforces.com/problemsets/acmsguru/problem/99999/249">SGU #249 <b>"Matrix"</b> &nbsp;&nbsp;&nbsp;&nbsp; [Difficulty: medium]</a></li>
</ul>

  <br>
</div>

<footer class="container-fluid wm-page-content">
      <p>
        <a href="https://d-k-ivanov.github.io/">Main site</a>
      </p><p>Copyright &copy; 2016-2020 Dmitry Ivanov. <script type="text/javascript"> (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)}; m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)}) (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym"); ym(40819844, "init", { clickmap:true, trackLinks:true, accurateTrackBounce:true }); </script> <noscript><div><img src="https://mc.yandex.ru/watch/40819844" style="position:absolute; left:-9999px;" alt="" /></div></noscript></p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>
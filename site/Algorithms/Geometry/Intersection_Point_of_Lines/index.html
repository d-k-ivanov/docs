<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="Dmitriy Ivanov">
    <link rel="canonical" href="https://d-k-ivanov.github.io/docs/Algorithms/Geometry/Intersection_Point_of_Lines/">
    <link rel="shortcut icon" href="../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Intersection: Point of Lines - Technical Info</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <link href="../../../css/extra.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Intersection: Point of Lines", url: "#_top", children: [
              {title: "Solution", url: "#solution" },
              {title: "Implementation", url: "#implementation" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../mathjax-config.js"></script>
      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-80208201-1', 'd-k-ivanov.github.io');
        ga('send', 'pageview');
    </script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../Intersection_Segments/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../Intersection_Segments/" class="btn btn-xs btn-link">
        Intersection: Two Segments
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../Intersection_Circle-Line/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../Intersection_Circle-Line/" class="btn btn-xs btn-link">
        Intersection: Circle-Line
      </a>
    </div>
    
  </div>

    

    <h1 id="intersection-point-of-lines">Intersection: Point of Lines</h1>
<p>You are given two lines, described via the equations <span><span class="MathJax_Preview">a_1 x + b_1 y + c_1 = 0</span><script type="math/tex">a_1 x + b_1 y + c_1 = 0</script></span> and  <span><span class="MathJax_Preview">a_2 x + b_2 y + c_2 = 0</span><script type="math/tex">a_2 x + b_2 y + c_2 = 0</script></span>.
We have to find the intersection point of the lines, or determine that the lines are parallel.</p>
<h2 id="solution">Solution</h2>
<p>If two lines are not parallel, they intersect.
To find their intersection point, we need to solve the following system of linear equations:</p>
<div>
<div class="MathJax_Preview">\begin{cases} a_1 x + b_1 y + c_1 = 0 \\\\
a_2 x + b_2 y + c_2 = 0
\end{cases}</div>
<script type="math/tex; mode=display">\begin{cases} a_1 x + b_1 y + c_1 = 0 \\\\
a_2 x + b_2 y + c_2 = 0
\end{cases}</script>
</div>
<p>Using Cramer's rule, we can immediately write down the solution for the system, which will give us the required intersection point of the lines:</p>
<div>
<div class="MathJax_Preview">x = - \frac{\begin{vmatrix}c_1 &amp; b_1 \cr c_2 &amp; b_2\end{vmatrix}}{\begin{vmatrix}a_1 &amp; b_1 \cr a_2 &amp; b_2\end{vmatrix} } = - \frac{c_1 b_2 - c_2 b_1}{a_1 b_2 - a_2 b_1},$$
$$y = - \frac{\begin{vmatrix}a_1 &amp; c_1 \cr a_2 &amp; c_2\end{vmatrix}}{\begin{vmatrix}a_1 &amp; b_1 \cr a_2 &amp; b_2\end{vmatrix}} = - \frac{a_1 c_2 - a_2 c_1}{a_1 b_2 - a_2 b_1}.</div>
<script type="math/tex; mode=display">x = - \frac{\begin{vmatrix}c_1 & b_1 \cr c_2 & b_2\end{vmatrix}}{\begin{vmatrix}a_1 & b_1 \cr a_2 & b_2\end{vmatrix} } = - \frac{c_1 b_2 - c_2 b_1}{a_1 b_2 - a_2 b_1},$$
$$y = - \frac{\begin{vmatrix}a_1 & c_1 \cr a_2 & c_2\end{vmatrix}}{\begin{vmatrix}a_1 & b_1 \cr a_2 & b_2\end{vmatrix}} = - \frac{a_1 c_2 - a_2 c_1}{a_1 b_2 - a_2 b_1}.</script>
</div>
<p>If the denominator equals <span><span class="MathJax_Preview">0</span><script type="math/tex">0</script></span>, i.e.</p>
<div>
<div class="MathJax_Preview">\begin{vmatrix}a_1 &amp; b_1 \cr a_2 &amp; b_2\end{vmatrix} = a_1 b_2 - a_2 b_1 = 0 </div>
<script type="math/tex; mode=display">\begin{vmatrix}a_1 & b_1 \cr a_2 & b_2\end{vmatrix} = a_1 b_2 - a_2 b_1 = 0 </script>
</div>
<p>then either the system has no solutions (the lines are parallel and distinct) or there are infinitely many solutions (the lines overlap).
If we need to distinguish these two cases, we have to check if coefficients <span><span class="MathJax_Preview">c</span><script type="math/tex">c</script></span> are proportional with the same ratio as the coefficients <span><span class="MathJax_Preview">a</span><script type="math/tex">a</script></span> and <span><span class="MathJax_Preview">b</span><script type="math/tex">b</script></span>.
To do that we only have calculate the following determinants, and if they both equal <span><span class="MathJax_Preview">0</span><script type="math/tex">0</script></span>, the lines overlap:</p>
<div>
<div class="MathJax_Preview">\begin{vmatrix}a_1 &amp; c_1 \cr a_2 &amp; c_2\end{vmatrix}, \begin{vmatrix}b_1 &amp; c_1 \cr b_2 &amp; c_2\end{vmatrix} </div>
<script type="math/tex; mode=display">\begin{vmatrix}a_1 & c_1 \cr a_2 & c_2\end{vmatrix}, \begin{vmatrix}b_1 & c_1 \cr b_2 & c_2\end{vmatrix} </script>
</div>
<p>Notice, a different approach for computing the intersection point is explained in the article <a href="/docs/#Algorithms/Geometry/Basic_Geometry/">Basic Geometry</a>.</p>
<h2 id="implementation">Implementation</h2>
<p>```cpp line_intersection
struct pt {
    double x, y;
};</p>
<p>struct line {
    double a, b, c;
};</p>
<p>const double EPS = 1e-9;</p>
<p>double det(double a, double b, double c, double d) {
    return a<em>d - b</em>c;
}</p>
<p>bool intersect(line m, line n, pt &amp; res) {
    double zn = det(m.a, m.b, n.a, n.b);
    if (abs(zn) &lt; EPS)
        return false;
    res.x = -det(m.c, m.b, n.c, n.b) / zn;
    res.y = -det(m.a, m.c, n.a, n.c) / zn;
    return true;
}</p>
<p>bool parallel(line m, line n) {
    return abs(det(m.a, m.b, n.a, n.b)) &lt; EPS;
}</p>
<p>bool equivalent(line m, line n) {
    return abs(det(m.a, m.b, n.a, n.b)) &lt; EPS
        &amp;&amp; abs(det(m.a, m.c, n.a, n.c)) &lt; EPS
        &amp;&amp; abs(det(m.b, m.c, n.b, n.c)) &lt; EPS;
}
```</p>

  <br>
</div>

<footer class="container-fluid wm-page-content">
      <p>
        <a href="https://d-k-ivanov.github.io/">Main site</a>
      </p><p>Copyright &copy; 2016-2020 Dmitriy Ivanov. <script type="text/javascript"> (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)}; m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)}) (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym"); ym(40819844, "init", { clickmap:true, trackLinks:true, accurateTrackBounce:true }); </script> <noscript><div><img src="https://mc.yandex.ru/watch/40819844" style="position:absolute; left:-9999px;" alt="" /></div></noscript></p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>
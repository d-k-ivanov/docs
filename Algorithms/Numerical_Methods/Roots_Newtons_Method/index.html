<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="Dmitry Ivanov">
    <link rel="canonical" href="https://d-k-ivanov.github.io/docs/Algorithms/Numerical_Methods/Roots_Newtons_Method/">
    <link rel="shortcut icon" href="../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Roots: Newton's Method - Technical Info</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <link href="../../../css/extra.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Roots: Newton's Method", url: "#_top", children: [
              {title: "Algorithm", url: "#algorithm" },
              {title: "Application for calculating the square root", url: "#application-for-calculating-the-square-root" },
              {title: "Practice Problems", url: "#practice-problems" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../mathjax-config.js"></script>
      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-80208201-1', 'd-k-ivanov.github.io');
        ga('send', 'pageview');
    </script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../Simpsons_Integration_Formula/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../Simpsons_Integration_Formula/" class="btn btn-xs btn-link">
        Simpson's Integration Formula
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../Misc/Stern-Brocot_Tree_and_Farey_Sequences/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../Misc/Stern-Brocot_Tree_and_Farey_Sequences/" class="btn btn-xs btn-link">
        Stern-Brocot Tree and Farey Sequences
      </a>
    </div>
    
  </div>

    

    <h1 id="roots-newtons-method">Roots: Newton's Method<a class="headerlink" href="#roots-newtons-method" title="Permanent link">#</a></h1>
<p>This is an iterative method invented by Isaac Newton around 1664. However, this method is also sometimes called the Raphson method, since Raphson invented the same algorithm a few years after Newton, but his article was published much earlier.</p>
<p>The task is as follows. Given the following equation:</p>
<div>
<div class="MathJax_Preview">f(x) = 0</div>
<script type="math/tex; mode=display">f(x) = 0</script>
</div>
<p>We want to solve the equation. More precisely, we want to find one of its roots (it is assumed that the root exists). It is assumed that <span><span class="MathJax_Preview">f(x)</span><script type="math/tex">f(x)</script></span> is continuous and differentiable on an interval <span><span class="MathJax_Preview">[a, b]</span><script type="math/tex">[a, b]</script></span>.</p>
<h2 id="algorithm">Algorithm<a class="headerlink" href="#algorithm" title="Permanent link">#</a></h2>
<p>The input parameters of the algorithm consist of not only the function <span><span class="MathJax_Preview">f(x)</span><script type="math/tex">f(x)</script></span> but also the initial approximation - some <span><span class="MathJax_Preview">x_0</span><script type="math/tex">x_0</script></span>, with which the algorithm starts.</p>
<p>Suppose we have already calculated <span><span class="MathJax_Preview">x_i</span><script type="math/tex">x_i</script></span>, calculate <span><span class="MathJax_Preview">x_{i+1}</span><script type="math/tex">x_{i+1}</script></span> as follows. Draw the tangent to the graph of the function <span><span class="MathJax_Preview">f(x)</span><script type="math/tex">f(x)</script></span> at the point <span><span class="MathJax_Preview">x = x_i</span><script type="math/tex">x = x_i</script></span>, and find the point of intersection of this tangent with the <span><span class="MathJax_Preview">x</span><script type="math/tex">x</script></span>-axis. <span><span class="MathJax_Preview">x_{i+1}</span><script type="math/tex">x_{i+1}</script></span> is set equal to the <span><span class="MathJax_Preview">x</span><script type="math/tex">x</script></span>-coordinate of the point found, and we repeat the whole process from the beginning.</p>
<p>It is not difficult to obtain the following formula:</p>
<div>
<div class="MathJax_Preview"> x_{i+1} = x_i - \frac{f(x_i)}{f^\prime(x_i)} </div>
<script type="math/tex; mode=display"> x_{i+1} = x_i - \frac{f(x_i)}{f^\prime(x_i)} </script>
</div>
<p>It is intuitively clear that if the function <span><span class="MathJax_Preview">f(x)</span><script type="math/tex">f(x)</script></span> is "good" (smooth), and <span><span class="MathJax_Preview">x_i</span><script type="math/tex">x_i</script></span> is close enough to the root, then <span><span class="MathJax_Preview">x_{i+1}</span><script type="math/tex">x_{i+1}</script></span> will be even closer to the desired root.</p>
<p>The rate of convergence is quadratic, which, conditionally speaking, means that the number of exact digits in the approximate value <span><span class="MathJax_Preview">x_i</span><script type="math/tex">x_i</script></span> doubles with each iteration.</p>
<h2 id="application-for-calculating-the-square-root">Application for calculating the square root<a class="headerlink" href="#application-for-calculating-the-square-root" title="Permanent link">#</a></h2>
<p>Let's use the calculation of square root as an example of Newton's method.</p>
<p>If we substitute <span><span class="MathJax_Preview">f(x) = x^2 - n</span><script type="math/tex">f(x) = x^2 - n</script></span>, then after simplifying the expression, we get:</p>
<div>
<div class="MathJax_Preview"> x_{i+1} = \frac{x_i + \frac{n}{x_i}}{2} </div>
<script type="math/tex; mode=display"> x_{i+1} = \frac{x_i + \frac{n}{x_i}}{2} </script>
</div>
<p>The first typical variant of the problem is when a rational number <span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> is given, and its root must be calculated with some accuracy <code>eps</code>:</p>
<pre><code class="language-cpp">double sqrt_newton(double n) {
    const double eps = 1E-15;
    double x = 1;
    for (;;) {
        double nx = (x + n / x) / 2;
        if (abs(x - nx) &lt; eps)
            break;
        x = nx;
    }
    return x;
}
</code></pre>
<p>Another common variant of the problem is when we need to calculate the integer root (for the given <span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> find the largest <span><span class="MathJax_Preview">x</span><script type="math/tex">x</script></span> such that <span><span class="MathJax_Preview">x^2 \le n</span><script type="math/tex">x^2 \le n</script></span>). Here it is necessary to slightly change the termination condition of the algorithm, since it may happen that <span><span class="MathJax_Preview">x</span><script type="math/tex">x</script></span> will start to "jump" near the answer. Therefore, we add a condition that if the value <span><span class="MathJax_Preview">x</span><script type="math/tex">x</script></span> has decreased in the previous step, and it tries to increase at the current step, then the algorithm must be stopped.</p>
<pre><code class="language-cpp">int isqrt_newton(int n) {
    int x = 1;
    bool decreased = false;
    for (;;) {
        int nx = (x + n / x) &gt;&gt; 1;
        if (x == nx || nx &gt; x &amp;&amp; decreased)
            break;
        decreased = nx &lt; x;
        x = nx;
    }
    return x;
}
</code></pre>
<p>Finally, we are given the third variant - for the case of bignum arithmetic. Since the number <span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> can be large enough, it makes sense to pay attention to the initial approximation. Obviously, the closer it is to the root, the faster the result will be achieved. It is simple enough and effective to take the initial approximation as the number <span><span class="MathJax_Preview">2^{\textrm{bits}/2}</span><script type="math/tex">2^{\textrm{bits}/2}</script></span>, where <span><span class="MathJax_Preview">\textrm{bits}</span><script type="math/tex">\textrm{bits}</script></span> is the number of bits in the number <span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span>. Here is the Java code that demonstrates this variant:</p>
<pre><code class="language-java">public static BigInteger isqrtNewton(BigInteger n) {
    BigInteger a = BigInteger.ONE.shiftLeft(n.bitLength() / 2);
    boolean p_dec = false;
    for (;;) {
        BigInteger b = n.divide(a).add(a).shiftRight(1);
        if (a.compareTo(b) == 0 || a.compareTo(b) &lt; 0 &amp;&amp; p_dec)
            break;
        p_dec = a.compareTo(b) &gt; 0;
        a = b;
    }
    return a;
}
</code></pre>
<p>For example, this code is executed in <span><span class="MathJax_Preview">60</span><script type="math/tex">60</script></span> milliseconds for <span><span class="MathJax_Preview">n = 10^{1000}</span><script type="math/tex">n = 10^{1000}</script></span>, and if we remove the improved selection of the initial approximation (just starting with <span><span class="MathJax_Preview">1</span><script type="math/tex">1</script></span>), then it will be executed in about <span><span class="MathJax_Preview">120</span><script type="math/tex">120</script></span> milliseconds.</p>
<h2 id="practice-problems">Practice Problems<a class="headerlink" href="#practice-problems" title="Permanent link">#</a></h2>
<ul>
<li><a href="https://uva.onlinejudge.org/index.php?option=com_onlinejudge&amp;Itemid=8&amp;category=16&amp;page=show_problem&amp;problem=1369">UVa 10428 - The Roots</a></li>
</ul>

  <br>
</div>

<footer class="container-fluid wm-page-content">
      <p>
        <a href="https://d-k-ivanov.github.io/">Main site</a>
      </p><p>Copyright &copy; 2016-2020 Dmitry Ivanov. <script type="text/javascript"> (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)}; m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)}) (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym"); ym(40819844, "init", { clickmap:true, trackLinks:true, accurateTrackBounce:true }); </script> <noscript><div><img src="https://mc.yandex.ru/watch/40819844" style="position:absolute; left:-9999px;" alt="" /></div></noscript></p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>